RewriteEngine On

# API Routes - handle all /api/admin/* requests
RewriteRule ^api/admin/sites(/.*)?$ api/admin/sites.php [L,QSA]

# Health check endpoint
RewriteRule ^health$ health.php [L]

# Agent portal routes - serve directly if file exists, otherwise route through router
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^agents/ - [L]

# Agent routes that don't exist as files go through router
RewriteRule ^agents/(.+)$ router.php [L,QSA]

# Admin-dashboard.php - serve directly (MUST be before generic admin rule)
RewriteRule ^admin-dashboard\.php$ - [L]

# Admin routes - route through router.php
RewriteRule ^admin(.*)$ router.php [L,QSA]

# Default routing for other files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ router.php [L,QSA]